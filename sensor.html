<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Tent Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f5f5f5;
            color: #333;
        }

        /* Header */
        .header {
            background: #4CAF50;
            color: white;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .tent-selector {
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
        }

        /* Navigation */
        .nav-tabs {
            background: white;
            padding: 10px 20px;
            display: flex;
            gap: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .nav-tab {
            background: #e0e0e0;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            text-decoration: none;
            color: #666;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .nav-tab.active {
            background: #4CAF50;
            color: white;
        }

        /* Main Content */
        .container {
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }

        /* Section */
        .section {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .section-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            font-size: 18px;
            font-weight: 600;
        }

        /* Sensor Grid */
        .sensor-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .sensor-card {
            background: #f8f8f8;
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            border-top: 4px solid #4CAF50;
        }

        .sensor-icon {
            font-size: 40px;
            margin-bottom: 10px;
        }

        .sensor-value {
            font-size: 28px;
            font-weight: 700;
            color: #4CAF50;
            margin: 10px 0;
        }

        .sensor-label {
            font-size: 14px;
            color: #666;
        }

        /* Buttons */
        .button-group {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .btn {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 25px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary {
            background: #4CAF50;
            color: white;
        }

        .btn-secondary {
            background: #e0e0e0;
            color: #666;
        }

        /* Camera Section */
        .camera-container {
            background: #000;
            border-radius: 15px;
            overflow: hidden;
            position: relative;
            aspect-ratio: 16/9;
            margin-bottom: 15px;
        }

        .camera-container img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .camera-status {
            position: absolute;
            top: 15px;
            left: 15px;
            background: #f44336;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .camera-controls {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div class="header">
        <div class="header-left">
            <span>déconnection 🏕️</span>
            <button class="tent-selector">🏕️ tente principale ▼</button>
        </div>
        <div class="header-right">
            <span>🌐 En ligne</span>
            <span>📊 <span id="dataUsage">0</span> MB</span>
        </div>
    </div>

    <!-- Navigation -->
    <div class="nav-tabs">
        <a href="#" class="nav-tab active">🏠 Tableau de bord</a>
        <a href="#" class="nav-tab">📈 Historique</a>
        <a href="#" class="nav-tab">🗺️ Carte</a>
        <a href="#" class="nav-tab">⚙️ Paramètres</a>
    </div>

    <!-- Main Content -->
    <div class="container">
        <!-- Conditions Intérieures -->
        <div class="section">
            <div class="section-header">
                <span>🏠</span>
                <span>Conditions Intérieures</span>
            </div>
            
            <div class="sensor-grid">
                <div class="sensor-card">
                    <div class="sensor-icon">🌡️</div>
                    <div class="sensor-value" id="tempInt">--°C</div>
                    <div class="sensor-label">Température</div>
                </div>
                
                <div class="sensor-card">
                    <div class="sensor-icon">💧</div>
                    <div class="sensor-value" id="humInt">--%</div>
                    <div class="sensor-label">Humidité</div>
                </div>
                
                <div class="sensor-card">
                    <div class="sensor-icon">💨</div>
                    <div class="sensor-value" id="gas">-- ppm</div>
                    <div class="sensor-label">Gaz (MQ2)</div>
                </div>
                
                <div class="sensor-card">
                    <div class="sensor-icon">👁️</div>
                    <div class="sensor-value" id="movementInt">Aucun</div>
                    <div class="sensor-label">Mouvement</div>
                </div>
            </div>
            
            <div class="button-group">
                <button class="btn btn-primary">🌡️ Mode Confort</button>
                <button class="btn btn-secondary" onclick="refreshData()">🔄 Actualiser</button>
            </div>
        </div>

        <!-- Conditions Extérieures -->
        <div class="section">
            <div class="section-header">
                <span>🌍</span>
                <span>Conditions Extérieures</span>
            </div>
            
            <div class="sensor-grid">
                <div class="sensor-card">
                    <div class="sensor-icon">🌡️</div>
                    <div class="sensor-value" id="tempExt">--°C</div>
                    <div class="sensor-label">Température</div>
                </div>
                
                <div class="sensor-card">
                    <div class="sensor-icon">💧</div>
                    <div class="sensor-value" id="humExt">--%</div>
                    <div class="sensor-label">Humidité</div>
                </div>
                
                <div class="sensor-card">
                    <div class="sensor-icon">🌬️</div>
                    <div class="sensor-value" id="wind">-- km/h</div>
                    <div class="sensor-label">Vent</div>
                </div>
                
                <div class="sensor-card">
                    <div class="sensor-icon">🚶</div>
                    <div class="sensor-value" id="movementExt">Aucun</div>
                    <div class="sensor-label">Mouvement</div>
                </div>
            </div>
            
            <div class="button-group">
                <button class="btn btn-primary">🌤️ Météo</button>
                <button class="btn btn-secondary" onclick="refreshData()">🔄 Actualiser</button>
            </div>
        </div>

        <!-- Système -->
        <div class="section">
            <div class="section-header">
                <span>🔧</span>
                <span>Système</span>
            </div>
            
            <div class="sensor-grid">
                <div class="sensor-card">
                    <div class="sensor-icon">📡</div>
                    <div class="sensor-value" id="signal">-- %</div>
                    <div class="sensor-label">Signal 4G</div>
                </div>
                
                <div class="sensor-card">
                    <div class="sensor-icon">🔋</div>
                    <div class="sensor-value" id="battery">-- %</div>
                    <div class="sensor-label">Batterie</div>
                </div>
                
                <div class="sensor-card">
                    <div class="sensor-icon">💻</div>
                    <div class="sensor-value" id="cpuTemp">--°C</div>
                    <div class="sensor-label">CPU Temp</div>
                </div>
            </div>
            
            <div class="button-group">
                <button class="btn btn-primary">🔍 Diagnostic</button>
                <button class="btn btn-secondary">⚡ Optimiser</button>
            </div>
        </div>

        <!-- Surveillance -->
        <div class="section">
            <div class="section-header">
                <span>📹</span>
                <span>Surveillance</span>
            </div>
            
            <div class="camera-container">
                <img id="cameraFeed" src="http://192.168.158.68/stream" alt="Camera feed">
                <div class="camera-status">🔴 EN DIRECT</div>
            </div>
            
            <div class="camera-controls">
                <button class="btn btn-primary">📸 Photo</button>
                <button class="btn btn-secondary">👁️ Détection</button>
                <button class="btn btn-secondary">🎥 Enregistrer</button>
                <button class="btn btn-secondary">🔍 Plein écran</button>
            </div>
        </div>
    </div>

    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-database-compat.js"></script>

    <script>
        // Configuration Firebase - REMPLACEZ PAR VOS CLÉS
        const firebaseConfig = {
            apiKey: "IzaSyCiXvPYhgNQlrPJfA067hM-7eL5L88QlCE",
            authDomain: "smart-tent-iot.firebaseapp.com",
            databaseURL: "https://smart-tent-iot-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "smart-tent-iot",
            storageBucket: "smart-tent-iot.firebasestorage.ap",
            messagingSenderId: "Y99002146412",
            appId: "1:99002146412:web:a5123156ac49de6db74249"
        };

        let database;
        let dataUsage = 0;

        // Initialiser Firebase
        function initFirebase() {
            firebase.initializeApp(firebaseConfig);
            database = firebase.database();
            
            // Écouter les données
            const sensorRef = database.ref('sensors/tent_01');
            sensorRef.on('value', (snapshot) => {
                const data = snapshot.val();
                if (data) {
                    updateDashboard(data);
                    dataUsage += 0.01;
                    document.getElementById('dataUsage').textContent = dataUsage.toFixed(2);
                }
            });
        }

        // Mettre à jour le dashboard
        function updateDashboard(data) {
            // Intérieur
            document.getElementById('tempInt').textContent = Math.round(data.temperature_interior * 10) / 10 + '°C';
            document.getElementById('humInt').textContent = Math.round(data.humidity_interior) + '%';
            document.getElementById('gas').textContent = Math.round(data.gas_ppm) + ' ppm';
            document.getElementById('movementInt').textContent = data.movement || 'Aucun';
            
            // Extérieur
            document.getElementById('tempExt').textContent = Math.round(data.temperature_exterior * 10) / 10 + '°C';
            document.getElementById('humExt').textContent = Math.round(data.humidity_exterior) + '%';
            document.getElementById('wind').textContent = Math.round(data.wind_speed) + ' km/h';
            document.getElementById('movementExt').textContent = 'Aucun';
            
            // Système
            document.getElementById('signal').textContent = Math.round(data.signal_4g) + ' %';
            document.getElementById('battery').textContent = Math.round(data.battery) + ' %';
            document.getElementById('cpuTemp').textContent = Math.round(data.cpu_temp || 52) + '°C';
        }

        // Rafraîchir les données
        function refreshData() {
            console.log('Actualisation...');
        }

        // Au chargement
        window.onload = function() {
            // Mode démo si pas de Firebase
            if (firebaseConfig.apiKey === "YOUR-API-KEY") {
                setInterval(() => {
                    const demoData = {
                        temperature_interior: 20 + Math.random() * 10,
                        humidity_interior: 50 + Math.random() * 30,
                        gas_ppm: 30 + Math.random() * 50,
                        temperature_exterior: 18 + Math.random() * 12,
                        humidity_exterior: 60 + Math.random() * 30,
                        wind_speed: 5 + Math.random() * 20,
                        signal_4g: 70 + Math.random() * 30,
                        battery: 80 + Math.random() * 20,
                        movement: Math.random() > 0.8 ? 'Détecté' : 'Aucun'
                    };
                    updateDashboard(demoData);
                }, 3000);
            } else {
                initFirebase();
            }
        };
    </script>
</body>
</html>
